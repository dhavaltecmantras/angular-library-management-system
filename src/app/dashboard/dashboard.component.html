<div class="container-fluid">
  <div class="row w-100">
    <div class="col-lg-12">
      <app-header [userName]="userName"></app-header>
    </div>
  </div>
  <div class="row" *ngIf="this.userDetails.user.role == 1">
    <div
      class="col-lg-3 mb-3 d-flex align-items-stretch"
      style="margin-top: 5%"
    >
      <div class="card h-100"></div>
    </div>
    <div
      class="col-lg-9 mb-3 d-flex align-items-stretch"
      style="margin-top: 5%"
    >
      <div class="card h-100">
        <div class="card-header">
          <h5 class="card-title">Library Management</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-2">
              <button (click)="openPopup()" class="btn btn-primary float-right">
                Add Book Details
              </button>
            </div>
          </div>
          <br />
          <div class="row">
            <div class="col-lg-12">
              <kendo-grid
                [data]="gridData"
                [pageSize]="5"
                [pageable]="true"
              >
                <kendo-grid-column field="id" title="ID"> </kendo-grid-column>
                <kendo-grid-column field="book_name" title="Book Name">
                </kendo-grid-column>
                <kendo-grid-column field="description" title="Description">
                </kendo-grid-column>
                <kendo-grid-column field="price" title="Price">
                </kendo-grid-column>
                <kendo-grid-column field="quantity" title="Quantity">
                </kendo-grid-column>
                <kendo-grid-column field="created_at" title="Created At">
                  <ng-template kendoGridCellTemplate let-dataItem>
                    {{ dataItem.created_at | date: "M/d/yy, h:mm a" }}
                  </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="created_at" title="Action">
                  <ng-template kendoGridCellTemplate let-dataItem>
                    <button
                      class="btn btn-success"
                      (click)="editBookDetails(dataItem.id)"
                    >
                      Edit
                    </button>
                    &nbsp;
                    <button
                      class="btn btn-danger"
                      (click)="deleteBookDetails(dataItem.id)"
                    >
                      Delete
                    </button>
                  </ng-template>
                </kendo-grid-column>
              </kendo-grid>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap Model Popup Start -->
  <div
    class="modal bd-example-modal-lg"
    tabindex="-1"
    role="dialog"
    aria-hidden="true"
    [ngStyle]="{ display: displayStyle }"
  >
    <form
      name="form"
      [formGroup]="addBookDetailsForm"
      (ngSubmit)="action == 'insert' ? addBookDetails() : updateBookDetails()"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Add Book Details</h4>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <input
                type="hidden"
                [value]="hiddenId"
                name="hiddenId"
                #hiddenId
              />
              <b><label> Book Name: </label></b>
              <input
                type="text"
                class="form-control"
                formControlName="book_name"
                [(ngModel)]="addBookFormData.book_name"
                placeholder="Enter Book Name"
                [ngClass]="{ 'is-invalid': submitted && f['book_name'].errors }"
              />
              <div
                *ngIf="submitted && f['book_name'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['book_name'].errors['required']">
                  Book Name is required.
                </div>
              </div>
            </div>
            <div class="form-group mt-3">
              <b><label> Description: </label></b>
              <textarea
                class="form-control"
                rows="5"
                formControlName="description"
                [(ngModel)]="addBookFormData.description"
                placeholder="Enter Books Description"
                [ngClass]="{
                  'is-invalid': submitted && f['description'].errors
                }"
              ></textarea>
              <div
                *ngIf="submitted && f['description'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['description'].errors['required']">
                  Description is required.
                </div>
              </div>
            </div>
            <div class="form-group mt-3">
              <b><label> Price: </label></b>
              <input
                type="text"
                class="form-control"
                formControlName="price"
                [(ngModel)]="addBookFormData.price"
                placeholder="Enter Book Price"
                [ngClass]="{ 'is-invalid': submitted && f['price'].errors }"
              />
              <div
                *ngIf="submitted && f['price'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['price'].errors['required']">
                  Book Price is required.
                </div>
              </div>
            </div>
            <div class="form-group mt-3">
              <b><label> Quantity: </label></b>
              <input
                type="number"
                class="form-control"
                formControlName="quantity"
                [(ngModel)]="addBookFormData.quantity"
                placeholder="Enter Total Quantity"
                [ngClass]="{ 'is-invalid': submitted && f['quantity'].errors }"
              />
              <div
                *ngIf="submitted && f['quantity'].errors"
                class="invalid-feedback"
              >
                <div *ngIf="f['quantity'].errors['required']">
                  Book quantity is required.
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">
              {{ buttonTitle }}
            </button>
            <button type="button" class="btn btn-danger" (click)="closePopup()">
              Close
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
  <!-- Bootstrap Model Popup End -->
</div>
